/* =========================
   Full replacement style.css
   - Single mobile breakpoint at <=768px (inclusive)
   - Topbar / capsule / tags consistent across sizes
   - Mobile content centered and aligned with topbar gutters
   - Fixes empty 768px canvas/sizer issue and restores scrolling
   ========================= */

/* -------------------------
   Theme tokens (kept from original)
   ------------------------- */
:root{
  --bg: #0b0b0c;                       /* page background */
  --panel: rgba(16,16,18,0.98);       /* opaque panel color used for topbar/capsule */
  --panel-solid: #0f0f10;             /* solid fallback */
  --muted: #9aa0a6;                   /* muted text */
  --accent: #e8eef2;                  /* light accent (same text color used previously) */
  --capsule-bg: rgba(20,20,22,0.92);
  --capsule-border: rgba(255,255,255,0.04);
  --btn-hover: rgba(255,255,255,0.03);
  --shadow: 0 12px 36px rgba(0,0,0,0.36);
  --max-inner-width: 1200px;
  --gutter-desktop: 28px;
  --gutter-mobile: 14px;
  --topbar-height: 64px;   /* visual topbar height (used in mobile math) */
  --capsule-height: 72px;
  --radius: 10px;
  --font-ui: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
}

/* Light-mode overrides (keep parity) */
body.light {
  --bg: #f7f7f8;
  --panel: rgba(255,255,255,0.98);
  --panel-solid: #ffffff;
  --muted: #6f777d;
  --accent: #222222;
  --capsule-bg: rgba(255,255,255,0.98);
  --capsule-border: rgba(0,0,0,0.06);
  --shadow: 0 10px 24px rgba(10,10,10,0.06);
}

/* -------------------------
   Global base
   ------------------------- */
* { box-sizing: border-box; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale; }
html,body { height:100%; width:100%; margin:0; padding:0; background:var(--bg); color:var(--accent); font-family:var(--font-ui); }
a { color:inherit; text-decoration:none; }
img { max-width:100%; display:block; }

/* -------------------------
   Container helpers
   ------------------------- */
#container { position:relative; width:100vw; height:100vh; overflow:hidden; box-sizing:border-box; }
.hidden { display:none !important; }

/* -------------------------
   Topbar - opaque panel + preserved structure
   ------------------------- */
.topbar{
  position: fixed;
  left: 50%;
  transform: translateX(-50%);
  top: 20px;
  width: min(var(--max-inner-width), calc(100% - 56px));
  z-index: 120;
  pointer-events: none;
  background: var(--panel);                 /* fully opaque panel color */
  border-radius: 12px;
  padding: 6px;
  border: 1px solid var(--capsule-border);
  box-shadow: 0 6px 20px rgba(0,0,0,0.45);
  backdrop-filter: blur(4px);
}
.topbar .topbar-inner{
  display:flex;
  gap:12px;
  align-items:center;
  justify-content:space-between;
  padding: 8px 16px;
  pointer-events: auto;
  background: transparent;
  border-radius: 8px;
}

/* brand */
.brand { display:flex; align-items:center; gap:12px; }
.brand-logo { width:44px; height:44px; border-radius:8px; object-fit:cover; }
.brand-text { display:flex; flex-direction:column; line-height:1; }
.brand-name { font-weight:700; font-size:16px; color:var(--accent); }
.brand-sub { font-size:12px; color:var(--muted); }

/* topbar actions */
.topbar-actions { display:flex; gap:12px; align-items:center; }

/* CV / Resume button - preserved look on desktop */
.btn { display:inline-flex; align-items:center; gap:10px; padding:10px 14px; border-radius:12px; background:transparent; border:1px solid transparent; cursor:pointer; font-weight:700; font-size:14px; color:inherit; }
.cv-btn {
  display:inline-flex; align-items:center; gap:8px;
  padding:10px 12px;
  border-radius:12px;
  background: linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  border:1px solid rgba(255,255,255,0.02);
  color:var(--muted);
}
.cv-btn .cv-label { display:inline-block; font-weight:700; font-size:13px; color:var(--accent); }

/* show inline icons (if provided) but hide by default on desktop only when mobile hides label */
.cv-btn img, .cv-btn svg { display:inline-block; width:20px; height:20px; object-fit:contain; }

/* theme toggle button */
.svg-theme-btn { width:44px; height:44px; border-radius:10px; display:inline-flex; align-items:center; justify-content:center; border:0; background:transparent; cursor:pointer; }
.svg-theme-btn:focus { outline:2px solid rgba(255,255,255,0.06); outline-offset:4px; }

/* Icon states: default = dark (moon), light mode = sun */
.svg-theme-btn .icon-sun {
  display: none;
}

.svg-theme-btn .icon-sun circle,
.svg-theme-btn .icon-sun path,
.svg-theme-btn .icon-moon {
  fill: var(--accent);
  stroke: var(--accent);
}

.svg-theme-btn .icon-moon {
  display: block;
}

.svg-theme-btn.is-light .icon-sun {
  display: block;
}

.svg-theme-btn.is-light .icon-moon {
  display: none;
}



/* -------------------------
   Capsule (bottom navigation) - preserved
   ------------------------- */
.capsule{
  position: fixed;
  left: 50%;
  transform: translateX(-50%);
  bottom: 32px;
  display: inline-flex;
  gap: 10px;
  padding: 8px 10px;
  border-radius: 999px;
  background: var(--capsule-bg);
  border: 1px solid var(--capsule-border);
  align-items:center;
  z-index:60;
  box-shadow: var(--shadow);
}
.capsule .nav-btn {
  background: transparent;
  border: 0;
  color: var(--muted);
  padding: 10px 14px;
  font-size: 13px;
  border-radius: 999px;
  cursor:pointer;
  transition: transform .12s, background .12s, color .12s;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", "Courier New", monospace;
  letter-spacing: .6px;
  font-weight:600;
}
.capsule .nav-btn:hover { transform: translateY(-3px); color:var(--accent); background:var(--btn-hover); }
.capsule .nav-btn.active { background:var(--btn-hover); color:var(--accent); transform:translateY(-2px); box-shadow: 0 6px 18px rgba(0,0,0,0.16); }
.capsule .nav-btn:focus { outline:2px solid rgba(255,255,255,0.06); outline-offset:4px; }

/* -------------------------
   Contact popup
   ------------------------- */
.contact-popup {
  position: fixed;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 16px;
  background: rgba(0, 0, 0, 0.55);
  backdrop-filter: blur(6px);

  opacity: 0;
  pointer-events: none;
  transition: opacity 0.18s ease-out;
  z-index: 12000; /* above topbar / capsule */
}

.contact-popup.is-open {
  opacity: 1;
  pointer-events: auto;
}

.contact-popup-inner {
  width: 100%;
  max-width: 360px;
  background: var(--panel);
  border-radius: 18px;
  padding: 16px 16px 12px 16px;
  box-shadow: var(--shadow);
  border: 1px solid var(--capsule-border);

  transform: translateY(16px) scale(0.96);
  opacity: 0;
  transition: transform 0.2s ease-out, opacity 0.2s ease-out;
}

.contact-popup.is-open .contact-popup-inner {
  transform: translateY(0) scale(1);
  opacity: 1;
}

/* header */
.contact-popup-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
  margin-bottom: 6px;
}

.contact-popup-header h2 {
  margin: 0;
  font-size: 16px;
  font-weight: 600;
  color: var(--accent);
}

.contact-popup-close {
  border: 0;
  background: transparent;
  cursor: pointer;
  font-size: 16px;
  width: 28px;
  height: 28px;
  border-radius: 999px;
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--muted);
  transition: background 0.12s ease-out, transform 0.12s ease-out, color 0.12s ease-out;
}

.contact-popup-close:hover {
  background: var(--btn-hover);
  color: var(--accent);
  transform: translateY(-1px);
}

.contact-popup-sub {
  margin: 0 0 6px 0;
  font-size: 12px;
  color: var(--muted);
}

/* options list */
.contact-list {
  display: flex;
  flex-direction: column;
  gap: 6px;
  margin-top: 2px;
}

.contact-item {
  display: flex;
  align-items: center;
  gap: 10px;
  text-decoration: none;
  padding: 10px 10px;
  border-radius: 12px;
  background: rgba(255, 255, 255, 0.02);
  border: 1px solid transparent;
  cursor: pointer;
  transition: background 0.14s ease-out, transform 0.12s ease-out, border-color 0.14s ease-out;
}

.contact-item:hover {
  background: var(--btn-hover);
  border-color: rgba(255, 255, 255, 0.06);
  transform: translateY(-2px);
}

.contact-icon {
  width: 28px;
  height: 28px;
  border-radius: 999px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  background: rgba(255, 255, 255, 0.05);
}

.contact-text {
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.contact-label {
  font-size: 13px;
  font-weight: 500;
  color: var(--accent);
}

.contact-detail {
  font-size: 11px;
  color: var(--muted);
}

/* Prevent background scroll when popup open */
body.contact-open {
  overflow: hidden;
}

/* Mobile polish */
@media (max-width: 480px) {
  .contact-popup-inner {
    max-width: 100%;
    border-radius: 16px;
    padding: 16px 14px 10px 14px;
  }

  .contact-item {
    padding: 9px 9px;
  }
}


/* -------------------------
   Work page base
   ------------------------- */
#workView{
  position:absolute;
  left:0; right:0; top:0; bottom:0;
  display:flex; flex-direction:column;
  box-sizing:border-box; overflow:hidden; z-index:80;
  pointer-events:auto;
}
#workContent{
  width:100%;
  height:100%;
  box-sizing:border-box;
  padding:8px var(--gutter-desktop) 28px var(--gutter-desktop);
  overflow:hidden;
  position:relative;
  z-index:40;
}

/* keep tags and topbar behaviour consistent */
.work-top { position: relative; z-index:50; pointer-events: auto; margin-bottom:6px; }
.work-tags { display:flex; margin-top:8px; gap:10px; flex-wrap:wrap; }
.work-tag {
  padding:6px 14px; border-radius:20px; border:1px solid transparent; background: rgba(255,255,255,0.02);
  font-size:13px; cursor:pointer; color:var(--muted); transition: background .15s, color .15s, transform .12s;
}
.work-tag:hover { transform: translateY(-2px); background:var(--btn-hover); color:var(--accent); }
.work-tag.active { background:var(--accent); color:var(--panel); border-color:var(--accent); }

/* project label */
.project-label{
  position: fixed;
  left:50%;
  transform: translateX(-50%);
  bottom:110px;
  font-size:20px;
  font-weight:600;
  color:var(--accent);
  opacity:0;
  pointer-events:none;
  transition: opacity .15s, transform .15s;
  z-index:200;
}
.project-label.visible { opacity:.5; transform: translateX(-50%) translateY(-12px); }

/* -------------------------
   Desktop horizontal rail
   ------------------------- */
.work-rail {
  display:flex; flex-direction:row; flex-wrap:nowrap; align-items:flex-start; gap:36px;
  box-sizing:border-box; padding:8px 0 28px 0; height:100%; overflow-x:auto; overflow-y:hidden;
  scroll-snap-type: x mandatory; -webkit-overflow-scrolling: touch;
}
.work-rail::-webkit-scrollbar{ display:none; } .work-rail{ scrollbar-width: none; }

.work-rail .work-rail-inner { display:flex; flex-direction:row; gap:36px; box-sizing:border-box; }

/* year block and images */
.year-block { display:flex; flex-direction:row; align-items:flex-start; gap:24px; flex:0 0 auto; scroll-snap-align:start; min-width:540px; box-sizing:border-box; }
.year-meta { flex:0 0 140px; width:140px; display:flex; flex-direction:column; gap:6px; }
.year-title { font-size:32px; font-weight:700; color:var(--accent); }
.year-count { font-size:11px; color:var(--muted); }
.year-images { display:flex; gap:18px; align-items:flex-start; }

/* project card */
.project{
  flex:0 0 360px; width:360px; border-radius:var(--radius); overflow:hidden; cursor:pointer; position:relative;
  transition: transform .18s, opacity .18s, box-shadow .18s; scroll-snap-align:center; background:var(--panel);
}
.project img { width:100%; height:auto; display:block; transition: filter .18s, transform .25s, opacity .18s; object-fit:cover; max-width:100%; }
.project.dim img { filter:grayscale(100%) contrast(.95) brightness(.9); opacity:.55; }
.project.focused { transform: translateY(-6px); box-shadow: 0 18px 45px rgba(0,0,0,0.18); }
.project.focused img { filter:none; opacity:1; transform:scale(1.03); }
.project-meta { position:absolute; left:8px; bottom:8px; color:rgba(220,220,220,0.78); font-size:12px; z-index:6; }

/* arrows */
.work-arrow {
  position:absolute; bottom:8px; width:44px; height:44px; border-radius:10px;
  background:var(--capsule-bg); color:var(--accent); display:flex; align-items:center; justify-content:center;
  cursor:pointer; z-index:210; box-shadow:var(--shadow); transition: transform .12s, background .12s, opacity .12s;
}
.work-arrow:hover { transform: translateY(-3px); }
.work-arrow.left { left:8px; } .work-arrow.right { right:8px; }
.work-arrow svg { width:18px; height:18px; display:block; }

/* prevent selection while dragging */
.work-rail, .work-rail * { user-select:none; -webkit-user-select:none; -ms-user-select:none; -webkit-tap-highlight-color:transparent; }
.project img { -webkit-user-drag:none; pointer-events:auto; touch-action:none; }

/* -------------------------
   MOBILE <= 768px (inclusive)
   - mobile layout active at width <= 768px
   ------------------------- */
@media (max-width: 768px) {

  /* topbar: keep opaque panel background and smaller paddings
     Use the same inner width as #mobileWork so left edges align */
  .topbar {
    top: 12px;
    padding: 6px;
    width: min(var(--max-inner-width), calc(100% - 56px)); /* MATCH mobileWork */
    left:50%;
    transform:translateX(-50%);
    background: var(--panel) !important;
    border-radius: 10px;
  }
  .topbar .topbar-inner { padding: 8px 12px; }

  /* show brand text but smaller (user asked topbar should display labels) */
  .brand-text { display:flex; flex-direction:column; }
  .brand-name { font-size:14px; font-weight:700; color:var(--accent); }
  .brand-sub { font-size:11px; color:var(--muted); }

  /* capsule compact */
  .capsule { bottom: 12px; padding: 8px 10px; gap:8px; width: auto; left: 50%; transform: translateX(-50%); }

  /* align mobile content gutters with topbar width and center everything */
  #workContent {
    padding: 8px var(--gutter-mobile) 28px var(--gutter-mobile);
    box-sizing:border-box;
    height: auto !important;
    overflow: visible !important;
  }

  /* Force the canvas sizer and workView into normal flow so mobile list is visible */
  #workCanvasSizer {
    position: static !important;
    left: auto !important;
    width: 100% !important;
    max-width: 100% !important;
    transform: none !important;
  }
  #workView {
    position: relative !important;
    top: auto !important;
    left: auto !important;
    right: auto !important;
    bottom: auto !important;
    width: 100% !important;
    margin: 0 auto !important;
    height: auto !important;
    overflow: visible !important;
    padding-top: calc(var(--topbar-height) * 0.2); /* small gap under topbar */
  }

  /* Hide horizontal rail & arrows, mobile list is used */
  .work-rail { display: none !important; }
  .work-arrow.left, .work-arrow.right { display: none !important; visibility: hidden !important; }

  /* #mobileWork will be centered & bounded to the same inner width as topbar so everything aligns */
  #mobileWork {
    display: block !important;
    width: min(var(--max-inner-width), calc(100% - 56px));
    max-width: min(var(--max-inner-width), calc(100% - 56px));
    margin: 0 auto;
    padding: 32px 0 20px 0;
    box-sizing: border-box;
    padding-top: calc(var(--work-top-height, 56px) + 6px);
    scroll-padding-top: calc(var(--work-top-height, 56px) + 6px);
    overflow-y: auto !important;
    -webkit-overflow-scrolling: touch;
    /* compute visible height: viewport minus topbar - capsule - small gutter */
    max-height: calc(100vh - var(--topbar-height) - var(--capsule-height) - 40px);
    background: transparent;
  }

  /* ensure tags sit below topbar, not overlapping
     use actual topbar height token so we leave the correct gap */
  .work-top {
    --work-top-height: 48px;
    position: sticky !important;
    top: calc(var(--topbar-height) + 24px) !important; /* leave room under topbar */
    z-index: 80 !important;
    background: transparent;
    padding: 6px 0;
  }

  .mobile-year-section { margin-bottom: 10px; }
  .mobile-year-section .year-title { font-size:18px; font-weight:700; color:var(--accent); margin: 8px 6px; }

  /* mobile stacked cards */
  .mobile-card {
    display:block; position:relative; border-radius:12px; overflow:hidden;
    margin: 12px auto; box-shadow: 0 10px 26px rgba(0,0,0,0.18); text-decoration:none; color:inherit; background:var(--panel);
    width: 100%;
  }
  .mobile-card img { width:100%; height:220px; object-fit:cover; display:block; }
  .mobile-meta {
    position:absolute; left:12px; bottom:12px; padding:6px 10px; border-radius:8px;
    background: linear-gradient(180deg, rgba(0, 0, 0, 0.945), rgb(0, 0, 0));
    color: var(--accent); font-size:14px; font-weight:600;
  }

  /* fallback stacking if JS doesn't generate mobileWork items */
  .year-block { display:block !important; min-width:auto !important; gap:12px !important; padding:0 !important; }
  .year-meta { width:100% !important; display:flex; align-items:center; justify-content:space-between; padding:6px 0; box-sizing:border-box; background:transparent; }
  .year-title { font-size:20px !important; }
  .year-count { font-size:11px !important; }

  /* fluid project cards on mobile */
  .project { flex:0 0 auto !important; width:100% !important; border-radius:12px !important; margin-bottom:12px; }
  .project img { width:100% !important; height:auto !important; display:block !important; object-fit:cover !important; }
  .project-meta { left:12px !important; bottom:12px !important; font-size:12px; }

  /* project label reduced */
  .project-label { bottom:84px !important; font-size:16px; }

  /* CV button: hide label & show icon (if present). Keep element accessible. */
  .cv-btn { width:44px !important; height:44px !important; padding:0 !important; display:inline-flex !important; justify-content:center; align-items:center; gap:0; }
  .cv-btn .cv-label { display:none !important; }
  .cv-btn img, .cv-btn svg { display:inline-block !important; width:20px !important; height:20px !important; }

  /* ensure capsule is centered and above content */
  .capsule { left:50% !important; transform:translateX(-50%) !important; bottom:12px !important; }

  /* allow smooth scrolling on mobile */
  #container, html, body { -webkit-overflow-scrolling: touch; }
}

/* -------------------------
   Small phones adjustments (<600px)
   ------------------------- */
@media (max-width: 599px){
  .topbar { top: 8px; width: calc(100% - 20px); left:50%; transform:translateX(-50%); }
  .topbar .topbar-inner { padding: 6px 10px; }
  .brand-name { font-size:13px; }
  .brand-sub { font-size:10px; }
  #mobileWork { max-height: calc(100vh - (var(--topbar-height) * 0.9 + var(--capsule-height) * 0.9 + 28px)); }
}

/* MOBILE ≤ 425px — vertically centered canvas between topbar & capsule */
@media (max-width: 426px) {

  /* scalable vertical gap for breathing room */
  :root {
    --mobile-gap: clamp(
      10px,
      calc((100vh - var(--topbar-height) - var(--capsule-height)) * 0.06),
      48px
    );
  }

  /* Container spans from below topbar to above capsule */
  #container {
    position: absolute !important;
    left: 50% !important;
    transform: translateX(-50%) !important;

    width: 90vw !important;
    max-width: min(var(--max-inner-width), 90vw) !important;

    top: 0;
    bottom: calc(var(--capsule-height) + env(safe-area-inset-bottom, 0px)) !important;

    box-sizing: border-box !important;
    overflow: hidden !important;
    z-index: 50 !important;

    /* flexbox allows vertical centering  */
    display: flex !important;
    align-items: center !important;    /* vertical centering */
    justify-content: center !important; /* horizontal (safety) */
    padding: var(--mobile-gap) 0 !important; /* ensures visible gap above / below */
  }

  /* Canvas centered inside container */
  #container canvas {
    width: 100% !important;

    /* canvas height subtracts double gap so it fits */
    height: calc(100% - var(--mobile-gap) * 2) !important;

    max-height: 100% !important;
    display: block !important;

    /* Prevent browser from letting ASCII overflow out */
    position: relative !important;
  }

  /* Bars stay above container */
  .topbar {
    z-index: 9999 !important;
    width: 90vw !important;
    left: 50% !important;
    transform: translateX(-50%) !important;
  }

  .capsule {
    z-index: 9999 !important;
  }
}


/* Accessibility & touch tweaks */
@media (max-width: 900px) {
  .capsule .nav-btn, .btn, .work-arrow { padding:10px 12px; }
  .project { touch-action: pan-y; }
}

/* small polish */
.center { display:flex; align-items:center; justify-content:center; }

/* ensure topbar/capsule remain above everything */
.topbar, .capsule { z-index: 9999 !important; }

/* End of style.css */
